
<!DOCTYPE html>
<html class="no-js" lang="en">


<!-- Mirrored from wp.alithemes.com/html/evara/evara-frontend/page-login-register.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:26:06 GMT -->
<head>
    <meta charset="utf-8">
    <title>Thachu's Clothings</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/public/assets/imgs/theme/favicon.svg">
    <!-- Template CSS -->
    <link rel="stylesheet" href="/public/assets/css/main.css">

    <!-- SweetAlert CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

<!-- Fetch API Polyfill for older browsers -->
<script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=fetch"></script>

<!-- SweetAlert JS -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>

  <body>
    <!--================Login Box Area =================-->
    <section class="login_box_area">
      
      <div class="container p-2">
        <div class="login_form_inner pb-4">
        <div
          class="d-flex flex-wrap align-items-center justify-content-center  mb-2"
        >
          <h1 class="d-flex mt-2">Reset Password</h1>
        </div>
        <div class="row " style="    display: flex;
        align-items: center;
        justify-content: center;
        align-content: center;
        margin-top: 10rem;
    ">
          <div class="col-lg-6">
            <div class="login_wrap widget-taber-content p-30 background-white border-radius-5">
                <div class="padding_eight_all bg-white">
                    <% if (message) { %>
                      <h5 style="color: red;"><%= message %></h5>
                    <% } %>
                    <form id="passwordForm" action="/changePassword" method="post">
                        <!-- Your existing form fields here -->
                        <div class="form-group">
                            <input required="" type="password" name="password" placeholder="Old Password">
                        </div>
                        <div class="form-group">
                            <input required="" type="password" name="newpassword" placeholder="New Password">
                        </div>
                        <div class="form-group">
                            <input required="" type="password" name="repeatPassword" placeholder="Confirm Password">
                        </div>
                        <div class="form-group">
                            <button type="button" class="btn btn-fill-out btn-block hover-up" onclick="handleFormSubmission()">Update</button>
                        </div>
                    </form>
                    
            
                </div>
            </div>
        </div>
          
          </div>
        </div>
      </div>
    </section>
  </body>
</html>

<!-- Include SweetAlert and any other necessary scripts here -->

<script>
    function handleFormSubmission() {
        // Get form data
        const passwordForm = document.getElementById('passwordForm');
        const formData = new FormData(passwordForm);
        let password = formData.get('password');
        let newpassword = formData.get('newpassword');
        let repeatPassword = formData.get('repeatPassword');
        let body = { password, newpassword, repeatPassword };
        // Convert the object to a JSON string
        let jsonBody = JSON.stringify(body);
        // Make AJAX request
        fetch('/changePassword', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json', // Specify the content type as JSON
            },
            body: jsonBody,
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                Swal.fire({
                    icon: 'success',
                    title: 'Password Updated Successfully!',
                    showCancelButton: false,
                    confirmButtonText: 'OK',
                }).then((result) => {
                    // Redirect to the changepassword page after clicking OK
                    if (result.isConfirmed) {
                        window.location.href = '/EditproFile'; // Replace '/changepassword' with your actual changepassword page URL
                    }
                });
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: data.message,
                });
            }
        })
        .catch(error => {
            console.error('Error updating password:', error);
            Swal.fire({
                icon: 'error',
                title: 'Error',
                text: 'Password is incorrect',
            });
        });
    }
</script>

